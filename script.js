// Generated by CoffeeScript 2.7.0
var plot_data;
d3.json("salaries.json").then(function (salaries) {
  return d3.json("titles.json").then(function (titles) {
    return d3.json("divisions.json").then(function (divisions) {
      var dropdown, jobcodes, opts, title, x;
      dropdown = d3.select("body").select("select#division");
      opts = dropdown.selectAll("option").data(divisions).enter().append("option").text(function (d) {
        return d;
      }).attr("value", function (d) {
        return d;
      });
      // insert title into salaries dataset
      salaries.forEach(function (d) {
        return d.title = titles[d.JobCode];
      });
      // create object that has title -> job codes
      jobcodes = {};
      for (x in titles) {
        title = titles[x];
        if (!(jobcodes[title] != null)) {
          jobcodes[title] = [];
        }
        jobcodes[title].push(x);
      }
      // add
      return d3.select("button").on("click", function () {
        return plot_data(salaries, divisions, jobcodes);
      });
    });
  });
});
plot_data = function (salaries, divisions, jobcodes) {
  var first_name, last_name, selected_div;
  // grab form data
  last_name = d3.select("input#last_name").property("value");
  first_name = d3.select("input#first_name").property("value");
  // division
  selected_div = d3.select("select#division option:checked").text();
  // scope
  //    scope = d3.select("input#scope option:checked").text()
  return d3.select("div#chart").text(`hello ${first_name} ${last_name} (${selected_div})`);
};

// grab form info
// look for matching record
// find the job codes for that person's title
// look for other people with one of those job codes (overall, or within that division)
// dotplot of those points
// add boxplot over the dotplot